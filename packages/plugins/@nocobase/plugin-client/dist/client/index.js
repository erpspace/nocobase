/**
 * This file is part of the NocoBase (R) project.
 * Copyright (c) 2020-2024 NocoBase Co., Ltd.
 * Authors: NocoBase Team.
 *
 * This project is dual-licensed under AGPL-3.0 and NocoBase Commercial License.
 * For more information, please refer to: https://www.nocobase.com/agreement.
 */

!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react-i18next"),require("@nocobase/utils/client"),require("lodash"),require("@nocobase/client"),require("antd"),require("@ant-design/icons"),require("@formily/react"),require("react")):"function"==typeof define&&define.amd?define("@nocobase/plugin-client",["react-i18next","@nocobase/utils/client","lodash","@nocobase/client","antd","@ant-design/icons","@formily/react","react"],t):"object"==typeof exports?exports["@nocobase/plugin-client"]=t(require("react-i18next"),require("@nocobase/utils/client"),require("lodash"),require("@nocobase/client"),require("antd"),require("@ant-design/icons"),require("@formily/react"),require("react")):e["@nocobase/plugin-client"]=t(e["react-i18next"],e["@nocobase/utils/client"],e.lodash,e["@nocobase/client"],e.antd,e["@ant-design/icons"],e["@formily/react"],e.react)}(self,function(e,t,n,o,r,a,i,l){return function(){"use strict";var c={482:function(e){e.exports=a},505:function(e){e.exports=i},772:function(e){e.exports=o},584:function(e){e.exports=t},721:function(e){e.exports=r},467:function(e){e.exports=n},156:function(e){e.exports=l},238:function(t){t.exports=e}},u={};function s(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return c[e](n,n.exports,s),n.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};s.r(p),s.d(p,{default:function(){return eb}});var d=s("772"),m=s("721"),y=s("156"),f=s.n(y),b={name:"desktopRoutes",dumpRules:"required",migrationRules:["overwrite","schema-only"],inherit:!1,hidden:!1,description:null,fields:[{key:"ymgf0jxu1kg",name:"parentId",type:"bigInt",interface:"integer",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,isForeignKey:!0,uiSchema:{type:"number",title:'{{t("Parent ID")}}',"x-component":"InputNumber","x-read-pretty":!0}},{key:"b07aqgs2shv",name:"parent",type:"belongsTo",interface:"m2o",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,foreignKey:"parentId",treeParent:!0,onDelete:"CASCADE",uiSchema:{title:'{{t("Parent")}}',"x-component":"AssociationField","x-component-props":{multiple:!1,fieldNames:{label:"id",value:"id"}}},target:"desktopRoutes",targetKey:"id"},{key:"p8sxllsgin1",name:"children",type:"hasMany",interface:"o2m",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,foreignKey:"parentId",treeChildren:!0,onDelete:"CASCADE",uiSchema:{title:'{{t("Children")}}',"x-component":"AssociationField","x-component-props":{multiple:!0,fieldNames:{label:"id",value:"id"}}},target:"desktopRoutes",targetKey:"id",sourceKey:"id"},{key:"7y601o9bmih",name:"id",type:"bigInt",interface:"integer",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,autoIncrement:!0,primaryKey:!0,allowNull:!1,uiSchema:{type:"number",title:'{{t("ID")}}',"x-component":"InputNumber","x-read-pretty":!0}},{key:"m8s9b94amz3",name:"createdAt",type:"date",interface:"createdAt",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,field:"createdAt",uiSchema:{type:"datetime",title:'{{t("Created at")}}',"x-component":"DatePicker","x-component-props":{},"x-read-pretty":!0}},{key:"p3p69woziuu",name:"createdBy",type:"belongsTo",interface:"createdBy",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,target:"users",foreignKey:"createdById",uiSchema:{type:"object",title:'{{t("Created by")}}',"x-component":"AssociationField","x-component-props":{fieldNames:{value:"id",label:"nickname"}},"x-read-pretty":!0},targetKey:"id"},{key:"s0gw1blo4hm",name:"updatedAt",type:"date",interface:"updatedAt",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,field:"updatedAt",uiSchema:{type:"string",title:'{{t("Last updated at")}}',"x-component":"DatePicker","x-component-props":{},"x-read-pretty":!0}},{key:"d1l988n09gd",name:"updatedBy",type:"belongsTo",interface:"updatedBy",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,target:"users",foreignKey:"updatedById",uiSchema:{type:"object",title:'{{t("Last updated by")}}',"x-component":"AssociationField","x-component-props":{fieldNames:{value:"id",label:"nickname"}},"x-read-pretty":!0},targetKey:"id"},{key:"bo7btzkbyan",name:"title",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Title")}}'}},{key:"brt6tz4hgin",name:"tooltip",type:"string",interface:"textarea",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input.TextArea",title:'{{t("Tooltip")}}'}},{key:"ozl5d8t2d5e",name:"icon",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Icon")}}'}},{key:"6bbyhv00bp4",name:"schemaUid",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Schema UID")}}'}},{key:"6bbyhv00bp5",name:"menuSchemaUid",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Menu Schema UID")}}'}},{key:"6bbyhv00bp6",name:"tabSchemaName",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Tab Schema Name")}}'}},{key:"m0k5qbaktab",name:"type",type:"string",interface:"input",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Type")}}'}},{key:"ssuml1j2v1b",name:"options",type:"json",interface:"json",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,defaultValue:null,uiSchema:{type:"object","x-component":"Input.JSON","x-component-props":{autoSize:{minRows:5}},default:null,title:'{{t("Options")}}'}},{key:"jjmosjqhz8l",name:"sort",type:"sort",interface:"sort",description:null,collectionName:"desktopRoutes",parentKey:null,reverseKey:null,scopeKey:"parentId",uiSchema:{type:"number","x-component":"InputNumber","x-component-props":{stringMode:!0,step:"1"},"x-validator":"integer",title:'{{t("Sort")}}'}},{type:"belongsToMany",name:"roles",through:"rolesDesktopRoutes",target:"roles",onDelete:"CASCADE"},{type:"boolean",name:"hideInMenu",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Hide in menu")}}'}},{type:"boolean",name:"enableTabs",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Enable tabs")}}'}},{type:"boolean",name:"enableHeader",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Enable header")}}'}},{type:"boolean",name:"displayTitle",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Display title")}}'}},{type:"boolean",name:"hidden",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Hidden")}}'}}],category:[],logging:!0,autoGenId:!0,createdAt:!0,createdBy:!0,updatedAt:!0,updatedBy:!0,template:"tree",view:!1,tree:"adjacencyList",filterTargetKey:"id"},h=s("238"),v="client";function x(e){return d.i18n.t(e,{ns:v})}function g(){return(0,h.useTranslation)(v,{nsMode:"fallback"})}var k=s("482"),S=s("505"),R=s("584"),w=s("467"),I=s.n(w);function A(e,t,n){var o=!0,r=!1,a=void 0;try{for(var i,l=t[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var c,u=i.value;if(u.id===e){if(u.type===d.NocoBaseDesktopRouteType.page)return n?u.schemaUid:u.menuSchemaUid;return u.schemaUid}if(null===(c=u.children)||void 0===c?void 0:c.length){var s=A(e,u.children,n);if(s)return s}}}catch(e){r=!0,a=e}finally{try{!o&&null!=l.return&&l.return()}finally{if(r)throw a}}return null}function C(e,t){var n=!0,o=!1,r=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l,c=a.value;if(c.id===e)return c;if(null===(l=c.children)||void 0===l?void 0:l.length){var u=C(e,c.children);if(u)return u}}}catch(e){o=!0,r=e}finally{try{!n&&null!=i.return&&i.return()}finally{if(o)throw r}}return null}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function T(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var D=function(){var e,t,n,o,r,a,i=(0,S.useField)(),l=(0,S.useFieldSchema)(),c=(0,d.useDataBlockResource)(),u=(0,d.useDataBlockRequest)(),s=(0,d.useTableBlockContextBasicValue)(),p=(0,y.useRef)(null);p.current={service:u,resource:c};var m=(null==u?void 0:null===(e=u.data)||void 0===e?void 0:e.meta)||{},f=(0,y.useMemo)(function(){return{pageSize:null==m?void 0:m.pageSize,total:null==m?void 0:m.count,current:null==m?void 0:m.page}},[null==m?void 0:m.count,null==m?void 0:m.page,null==m?void 0:m.pageSize]),b=(null==u?void 0:null===(t=u.data)||void 0===t?void 0:t.data)||[];return(0,y.useEffect)(function(){if(!(null==u?void 0:u.loading)){var e,t,n=null===(t=s.field)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.selectedRowKeys;i.data=i.data||{},!I().isEqual(i.data.selectedRowKeys,n)&&(i.data.selectedRowKeys=n)}},[i,null==u?void 0:u.data,null==u?void 0:u.loading,null===(o=s.field)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:n.selectedRowKeys]),{optimizeTextCellRender:!1,value:b,loading:null==u?void 0:u.loading,showIndex:!0,dragSort:!1,rowKey:"id",pagination:(null==l?void 0:null===(r=l["x-component-props"])||void 0===r?void 0:r.pagination)!==!1&&f,onRowSelectionChange:(0,y.useCallback)(function(e,t,n){if(s){s.field.data=(null===(o=s.field)||void 0===o?void 0:o.data)||{};var o,r,a,i,l=s.field.data.selectedRecord,c=s.field.data.selected;s.field.data.selectedRowKeys=function(e,t,n,o){var r=T(e);if(0===r.length)return r;if(n)(s=r).push.apply(s,T(N(null==t?void 0:t.children)));else{for(var a=[],i=t;null==i?void 0:i.parentId;)a.push(i.parentId),i=C(i.parentId,o);var l=!0,c=!1,u=void 0;try{for(var s,p,d=a[Symbol.iterator]();!(l=(p=d.next()).done);l=!0)!function(){var e=p.value,t=C(e,o);t&&!N(t.children).every(function(e){return r.includes(e)})&&(r=r.filter(function(e){return e!==t.id}))}()}catch(e){c=!0,u=e}finally{try{!l&&null!=d.return&&d.return()}finally{if(c)throw u}}var m=N(null==t?void 0:t.children);r=r.filter(function(e){return!m.includes(e)})}return I().uniq(r)}(e,l,c,(null==u?void 0:null===(r=u.data)||void 0===r?void 0:r.data)||[]),n(s.field.data.selectedRowKeys),null===(a=(i=s.field).onRowSelect)||void 0===a||a.call(i,s.field.data.selectedRowKeys)}},[null==u?void 0:null===(a=u.data)||void 0===a?void 0:a.data,s]),onChange:(0,y.useCallback)(function(e,t,n){var o,r,a,i,c,u,d,m,y,f,b,h,v=e.current,x=e.pageSize,g=null===(c=l.parent)||void 0===c?void 0:null===(i=c["x-decorator-props"])||void 0===i?void 0:null===(a=i.params)||void 0===a?void 0:a.sort,k=n.order?"ascend"===n.order?[n.field]:["-".concat(n.field)]:g||s.dragSortBy,S=x||(null===(m=l.parent)||void 0===m?void 0:null===(d=m["x-decorator-props"])||void 0===d?void 0:null===(u=d.params)||void 0===u?void 0:u.pageSize);var R=(o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o,r,a;o=e,r=t,a=n[t],r in o?Object.defineProperty(o,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[r]=a})}return e}({},null===(b=p.current)||void 0===b?void 0:null===(f=b.service)||void 0===f?void 0:null===(y=f.params)||void 0===y?void 0:y[0]),r=(r={page:v||1,pageSize:S},r),Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))}),o);k&&(R.sort=k),null===(h=p.current)||void 0===h||h.service.run(R)},[l.parent])}};function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=!0,o=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;t.push(l.id),t.push.apply(t,T(N(l.children)))}}catch(e){o=!0,r=e}finally{try{!n&&null!=i.return&&i.return()}finally{if(o)throw r}}return t}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function P(e,t,n,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(o,r)}function K(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function i(e){P(a,o,r,i,l,"next",e)}function l(e){P(a,o,r,i,l,"throw",e)}i(void 0)})}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){B(e,t,n[t])})}return e}function F(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,o,r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{!i&&null!=r.return&&r.return()}finally{if(l)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){return!t&&(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function M(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function z(){var e=q(["\n                                  & > .ant-space-item:first-child,\n                                  & > .ant-space-item:last-child {\n                                    flex-shrink: 0;\n                                  }\n                                "]);return z=function(){return e},e}function V(){var e=q(["\n                                      & > .ant-space-item:first-child,\n                                      & > .ant-space-item:last-child {\n                                        flex-shrink: 0;\n                                      }\n                                    "]);return V=function(){return e},e}function L(){var e=q(["\n                                      & > .ant-space-item:first-child,\n                                      & > .ant-space-item:last-child {\n                                        flex-shrink: 0;\n                                      }\n                                    "]);return L=function(){return e},e}var _=(0,d.getVariableComponentWithScope)(d.Variable.TextArea),G=function(e,t){var n,o,r,a="mobileRoutes"===e;return{type:"void",name:(0,R.uid)(),"x-decorator":"TableBlockProvider","x-decorator-props":{collection:e,action:"list",dragSort:!1,params:{sort:["sort"],pageSize:20,filter:{"hidden.$ne":!0}},treeTable:!0},properties:{actions:{type:"void","x-component":"ActionBar","x-component-props":{style:{marginBottom:16}},properties:{refresh:{title:"{{t('Refresh')}}","x-action":"refresh","x-component":"Action","x-use-component-props":"useRefreshActionProps","x-component-props":{icon:"ReloadOutlined"}},delete:{type:"void",title:'{{t("Delete")}}',"x-component":"Action","x-use-component-props":function(){var t=(0,d.useTableBlockContextBasicValue)(),n=(0,d.useBlockRequestContext)(),o=n.resource,r=n.service,i=W().deleteRouteSchema,l=(0,d.useDataBlockRequestData)(),c=(0,d.useAllAccessDesktopRoutes)().refresh;return{onClick:function(){return K(function(){var n,u,s,p,d,m,y,f,b,h,v,x;return M(this,function(g){switch(g.label){case 0:if(!(null==(m=null===(u=t.field)||void 0===u?void 0:null===(n=u.data)||void 0===n?void 0:n.selectedRowKeys)?void 0:m.length))return[2];y=!0,f=!1,b=void 0,g.label=1;case 1:g.trys.push([1,6,7,8]),h=m[Symbol.iterator](),g.label=2;case 2:if(y=(v=h.next()).done)return[3,5];return[4,i(A(v.value,null==l?void 0:l.data,a))];case 3:g.sent(),g.label=4;case 4:return y=!0,[3,2];case 5:return[3,8];case 6:return x=g.sent(),f=!0,b=x,[3,8];case 7:try{!y&&null!=h.return&&h.return()}finally{if(f)throw b}return[7];case 8:return[4,o.destroy({filterByTk:m})];case 9:return g.sent(),null===(s=(p=t.field.data).clearSelectedRowKeys)||void 0===s||s.call(p),null==r||null===(d=r.refresh)||void 0===d||d.call(r),"desktopRoutes"===e&&c(),[2]}})})()}}},"x-component-props":{confirm:{title:"{{t('Delete routes')}}",content:"{{t('Are you sure you want to delete it?')}}"},icon:"DeleteOutlined"}},hide:{type:"void",title:'{{t("Hide in menu")}}',"x-component":"Action","x-use-component-props":function(){var t=(0,d.useTableBlockContextBasicValue)(),n=(0,d.useBlockRequestContext)().service,o=(0,d.useAllAccessDesktopRoutes)().refresh,r=(0,d.useNocoBaseRoutes)(e).updateRoute;return{onClick:function(){return K(function(){var e,a,i,l,c,u;return M(this,function(s){switch(s.label){case 0:if(!(null==(u=null===(a=t.field)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.selectedRowKeys)?void 0:u.length))return[2];return[4,r(u,{hideInMenu:!0})];case 1:return s.sent(),null===(i=(l=t.field.data).clearSelectedRowKeys)||void 0===i||i.call(l),null==n||null===(c=n.refresh)||void 0===c||c.call(n),o(),[2]}})})()}}},"x-component-props":{icon:"EyeInvisibleOutlined",confirm:{title:"{{t('Hide in menu')}}",content:"{{t('Are you sure you want to hide these routes in menu?')}}"}}},show:{type:"void",title:'{{t("Show in menu")}}',"x-component":"Action","x-use-component-props":function(){var t=(0,d.useTableBlockContextBasicValue)(),n=(0,d.useBlockRequestContext)().service,o=(0,d.useNocoBaseRoutes)(e).updateRoute;return{onClick:function(){return K(function(){var e,r,a,i,l,c;return M(this,function(u){switch(u.label){case 0:if(!(null==(c=null===(r=t.field)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.selectedRowKeys)?void 0:c.length))return[2];return[4,o(c,{hideInMenu:!1})];case 1:return u.sent(),null===(a=(i=t.field.data).clearSelectedRowKeys)||void 0===a||a.call(i),null==n||null===(l=n.refresh)||void 0===l||l.call(n),[2]}})})()}}},"x-component-props":{icon:"EyeOutlined",confirm:{title:"{{t('Show in menu')}}",content:"{{t('Are you sure you want to show these routes in menu?')}}"}}},create:{type:"void",title:'{{t("Add new")}}',"x-component":"Action","x-component-props":{type:"primary",icon:"PlusOutlined"},properties:{drawer:{type:"void","x-component":"Action.Drawer","x-decorator":"Form","x-decorator-props":{useValues:function(e){return{}}},title:'{{t("Add new")}}',properties:{formSchema:{type:"void",properties:(B(n={type:{type:"string",title:'{{t("Type")}}',"x-decorator":"FormItem","x-component":function(e){var t=(0,h.useTranslation)().t;return f().createElement(m.Radio.Group,e,!a&&f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.group},t("Group")),f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.page},t("Page")),f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.link},t("Link")))},default:d.NocoBaseDesktopRouteType.page,required:!0},title:{type:"string",title:'{{t("Title")}}',"x-decorator":"FormItem","x-component":"Input",required:!0},icon:{type:"string",title:'{{t("Icon")}}',"x-decorator":"FormItem","x-component":"IconPicker","x-reactions":a?{dependencies:["type"],fulfill:{state:{required:'{{$deps[0] !== "tabs"}}'}}}:void 0}},a?"url":"href",{title:'{{t("URL")}}',type:"string","x-decorator":"FormItem","x-component":_,description:'{{t("Do not concatenate search params in the URL")}}',"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}}}),B(n,"params",{type:"array","x-component":"ArrayItems","x-decorator":"FormItem",title:'{{t("Search parameters")}}',items:{type:"object",properties:{space:{type:"void","x-component":"Space","x-component-props":{style:{flexWrap:"nowrap",maxWidth:"100%"},className:(0,d.css)(z())},properties:{name:{type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{placeholder:'{{t("Name")}}'}},value:{type:"string","x-decorator":"FormItem","x-component":_,"x-component-props":{placeholder:'{{t("Value")}}',useTypedConstant:!0,changeOnSelect:!0}},remove:{type:"void","x-decorator":"FormItem","x-component":"ArrayItems.Remove"}}}}},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}},properties:{add:{type:"void",title:'{{t("Add parameter")}}',"x-component":"ArrayItems.Addition"}}}),B(n,"hideInMenu",{type:"boolean",title:'{{t("Show in menu")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the route will be displayed in the menu.`)}}"},"x-component":function(e){var t=U((0,y.useState)(!e.value),2),n=t[0],o=t[1];return f().createElement(m.Checkbox,{checked:n,onChange:function(){var t;o(!n),null===(t=e.onChange)||void 0===t||t.call(e,n)}})},default:!1}),B(n,"enableTabs",{type:"boolean",title:'{{t("Enable page tabs")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the page will display Tab pages.`)}}"},"x-component":function(e){return f().createElement(m.Checkbox,{checked:e.value,onChange:e.onChange})},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "page"}}'}}},default:!1}),n)},footer:{type:"void","x-component":"Action.Drawer.Footer",properties:{cancel:{title:'{{t("Cancel")}}',"x-component":"Action","x-component-props":{useAction:"{{ cm.useCancelAction }}"}},submit:{title:'{{t("Submit")}}',"x-component":"Action","x-component-props":{type:"primary",useAction:function(t){var n=(0,S.useForm)(),o=(0,S.useField)(),r=(0,d.useActionContext)(),i=(0,d.useDataBlockRequestGetter)().getDataBlockRequest,l=(0,d.useNocoBaseRoutes)(e).createRoute,c=$(a).createRouteSchema;return{run:function(){return K(function(){var e,u,s,p,m,y,f,b,h,v,x,g;return M(this,function(k){switch(k.label){case 0:return k.trys.push([0,5,,6]),[4,n.submit()];case 1:return k.sent(),o.data=o.data||{},o.data.loading=!0,[4,c(n.values)];case 2:return p=(s=k.sent()).pageSchemaUid,m=s.tabSchemaUid,y=s.menuSchemaUid,f=s.tabSchemaName,(n.values.href||!I().isEmpty(n.values.params))&&(b={params:n.values.params,href:a?void 0:n.values.href,url:a?n.values.url:void 0}),h={},m&&(h.children=[{schemaUid:m,type:d.NocoBaseDesktopRouteType.tabs,tabSchemaName:f,hidden:!(null===(v=n.values)||void 0===v?void 0:v.enableTabs)}]),[4,l(E(F(E({},I().omit(n.values,["href","params","url"])),{schemaUid:d.NocoBaseDesktopRouteType.page===n.values.type?p:y,menuSchemaUid:y,options:b}),h))];case 3:return x=k.sent(),r.setVisible(!1),null==t||t(null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.data),[4,n.reset()];case 4:return k.sent(),o.data.loading=!1,null===(u=i())||void 0===u||u.refresh(),[3,6];case 5:throw g=k.sent(),o.data&&(o.data.loading=!1),g;case 6:return[2]}})})()}}}}}}}}}}},filter:{"x-action":"filter",type:"object","x-component":"Filter.Action",title:"{{t('Filter')}}","x-use-component-props":"useFilterActionProps","x-component-props":{icon:"FilterOutlined"},"x-align":"left"}}},table:{type:"array","x-component":"TableV2","x-use-component-props":D,"x-component-props":{rowKey:"id",rowSelection:{type:"checkbox"}},properties:{title:{type:"void","x-component":"TableV2.Column",title:'{{t("Title")}}',"x-component-props":{width:200},properties:{title:{type:"string","x-component":function(e){var t=(0,d.useCollectionRecordData)(),n=(0,d.useMenuTranslation)().t,o=e.value;return t.type===d.NocoBaseDesktopRouteType.tabs&&I().isNil(e.value)&&(o=n("Unnamed")),f().createElement(d.CollectionField,F(E({},e),{value:n(o)}))},"x-read-pretty":!0,"x-component-props":{ellipsis:!0}}}},type:{type:"void","x-component":"TableV2.Column",title:'{{t("Type")}}',"x-component-props":{width:100},properties:{type:{type:"string","x-component":function(e){return f().createElement(H,{value:e.value})},"x-read-pretty":!0,"x-component-props":{ellipsis:!0}}}},hideInMenu:{type:"void","x-component":"TableV2.Column",title:'{{t("Show in menu")}}',"x-component-props":{width:100},properties:{hideInMenu:{type:"boolean","x-component":function(e){return e.value?f().createElement(k.CloseOutlined,{style:{color:"#ff4d4f"}}):f().createElement(k.CheckOutlined,{style:{color:"#52c41a"}})},"x-read-pretty":!0,"x-component-props":{ellipsis:!0}}}},path:{title:'{{t("Path")}}',type:"void","x-component":"TableV2.Column","x-component-props":{width:300},properties:{path:{type:"string","x-component":function(){var e=(0,d.useDataBlockRequestData)(),n=(0,d.useCollectionRecordData)(),o=(0,d.useRouterBasename)(),r=(0,h.useTranslation)().t;if(n.type===d.NocoBaseDesktopRouteType.group||n.type===d.NocoBaseDesktopRouteType.link)return null;if(n.type===d.NocoBaseDesktopRouteType.page){var i="".concat(o.slice(0,-1)).concat(t,"/").concat(a?n.schemaUid:n.menuSchemaUid);return n._path=i,f().createElement(m.Typography.Paragraph,{copyable:!0,style:{marginBottom:0},ellipsis:!0},i)}if(n.type===d.NocoBaseDesktopRouteType.tabs&&(null==e?void 0:e.data)){var l="".concat(o.slice(0,-1)).concat(t,"/").concat(A(n.parentId,e.data,a),"/tabs/").concat(n.tabSchemaName||n.schemaUid);return n._path=l,f().createElement(m.Typography.Paragraph,{copyable:!0,style:{marginBottom:0},ellipsis:!0},l)}return f().createElement(m.Tag,null,r("Unknown")," ")},"x-read-pretty":!0}}},actions:{type:"void",title:'{{t("Actions")}}',"x-component":"TableV2.Column",properties:{addChild:{type:"void",title:'{{t("Add child route")}}',"x-component":"Action.Link","x-use-component-props":function(){var e=(0,d.useCollectionRecordData)();return{disabled:e.type!==d.NocoBaseDesktopRouteType.group&&e.type!==d.NocoBaseDesktopRouteType.page||!e.enableTabs&&e.type===d.NocoBaseDesktopRouteType.page,openMode:"drawer"}},"x-decorator":"Space",properties:{drawer:{type:"void","x-component":"Action.Drawer","x-decorator":"Form","x-decorator-props":{useValues:function(e){return{}}},title:'{{t("Add child route")}}',properties:{formSchema:{type:"void",properties:(B(o={type:{type:"string",title:'{{t("Type")}}',"x-decorator":"FormItem","x-component":function(e){var t=(0,h.useTranslation)().t,n=(0,d.useCollectionRecordData)(),o=n.type===d.NocoBaseDesktopRouteType.page,r=n.type===d.NocoBaseDesktopRouteType.group,i=(0,y.useMemo)(function(){return o?(e.onChange(d.NocoBaseDesktopRouteType.tabs),d.NocoBaseDesktopRouteType.tabs):d.NocoBaseDesktopRouteType.page},[o,e]);return f().createElement(m.Radio.Group,F(E({},e),{defaultValue:i}),!a&&f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.group,disabled:!r},t("Group")),f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.page,disabled:!r},t("Page")),f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.link,disabled:!r},t("Link")),f().createElement(m.Radio,{value:d.NocoBaseDesktopRouteType.tabs,disabled:!o},t("Tab")))},required:!0,default:d.NocoBaseDesktopRouteType.page},title:{type:"string",title:'{{t("Title")}}',"x-decorator":"FormItem","x-component":"Input",required:!0},icon:{type:"string",title:'{{t("Icon")}}',"x-decorator":"FormItem","x-component":"IconPicker","x-reactions":a?{dependencies:["type"],fulfill:{state:{required:'{{$deps[0] !== "tabs"}}'}}}:void 0}},a?"url":"href",{title:'{{t("URL")}}',type:"string","x-decorator":"FormItem","x-component":_,description:'{{t("Do not concatenate search params in the URL")}}',"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}}}),B(o,"params",{type:"array","x-component":"ArrayItems","x-decorator":"FormItem",title:'{{t("Search parameters")}}',items:{type:"object",properties:{space:{type:"void","x-component":"Space","x-component-props":{style:{flexWrap:"nowrap",maxWidth:"100%"},className:(0,d.css)(V())},properties:{name:{type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{placeholder:'{{t("Name")}}'}},value:{type:"string","x-decorator":"FormItem","x-component":_,"x-component-props":{placeholder:'{{t("Value")}}',useTypedConstant:!0,changeOnSelect:!0}},remove:{type:"void","x-decorator":"FormItem","x-component":"ArrayItems.Remove"}}}}},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}},properties:{add:{type:"void",title:'{{t("Add parameter")}}',"x-component":"ArrayItems.Addition"}}}),B(o,"hideInMenu",{type:"boolean",title:'{{t("Show in menu")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the route will be displayed in the menu.`)}}"},"x-component":function(e){var t=U((0,y.useState)(!e.value),2),n=t[0],o=t[1];return f().createElement(m.Checkbox,{checked:n,onChange:function(){var t;o(!n),null===(t=e.onChange)||void 0===t||t.call(e,n)}})},default:!1}),B(o,"enableTabs",{type:"boolean",title:'{{t("Enable page tabs")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the page will display Tab pages.`)}}"},"x-component":function(e){return f().createElement(m.Checkbox,{checked:e.value,onChange:e.onChange})},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "page"}}'}}},default:!1}),o)},footer:{type:"void","x-component":"Action.Drawer.Footer",properties:{cancel:{title:'{{t("Cancel")}}',"x-component":"Action","x-component-props":{useAction:"{{ cm.useCancelAction }}"}},submit:{title:'{{t("Submit")}}',"x-component":"Action","x-component-props":{type:"primary",useAction:function(){var t=(0,S.useForm)(),n=(0,S.useField)(),o=(0,d.useActionContext)(),r=(0,d.useDataBlockRequestGetter)().getDataBlockRequest,i=(0,d.useNocoBaseRoutes)(e).createRoute,l=$(a),c=l.createRouteSchema,u=l.createTabRouteSchema,s=(0,d.useCollectionRecordData)();return{run:function(){return K(function(){var e,a,l,p,m,y,f,b,h,v,x,g,k,S;return M(this,function(R){switch(R.label){case 0:return R.trys.push([0,10,,11]),[4,t.submit()];case 1:if(R.sent(),n.data=n.data||{},n.data.loading=!0,t.values.type!==d.NocoBaseDesktopRouteType.tabs)return[3,4];return[4,u(F(E({},t.values),{parentSchemaUid:s.schemaUid}))];case 2:return l=(a=R.sent()).tabSchemaUid,p=a.tabSchemaName,[4,i(E({parentId:s.id,type:d.NocoBaseDesktopRouteType.tabs,schemaUid:l,tabSchemaName:p},t.values))];case 3:return R.sent(),[3,8];case 4:return[4,c(t.values)];case 5:return f=(y=R.sent()).pageSchemaUid,b=y.tabSchemaUid,h=y.menuSchemaUid,v=y.tabSchemaName,(t.values.href||!I().isEmpty(t.values.params))&&(m={href:t.values.href,params:t.values.params}),[4,i(F(E({parentId:s.id},I().omit(t.values,["href","params"])),{schemaUid:d.NocoBaseDesktopRouteType.page===t.values.type?f:h,menuSchemaUid:h,options:m}))];case 6:if(x=R.sent(),!b)return[3,8];return[4,i({parentId:null==x?void 0:null===(k=x.data)||void 0===k?void 0:null===(g=k.data)||void 0===g?void 0:g.id,type:d.NocoBaseDesktopRouteType.tabs,schemaUid:b,tabSchemaName:v,hidden:!0})];case 7:R.sent(),R.label=8;case 8:return o.setVisible(!1),[4,t.reset()];case 9:return R.sent(),n.data.loading=!1,null===(e=r())||void 0===e||e.refresh(),[3,11];case 10:throw S=R.sent(),n.data&&(n.data.loading=!1),S;case 11:return[2]}})})()}}}}}}}}}}},edit:{type:"void",title:'{{t("Edit")}}',"x-component":"Action.Link","x-component-props":{openMode:"drawer"},"x-decorator":"Space",properties:{drawer:{type:"void","x-component":"Action.Drawer","x-decorator":"Form","x-decorator-props":{useValues:function(e){var t=(0,d.useCollectionRecordData)(),n=(0,d.useActionContext)();return(0,d.useRequest)(function(){var e,n,o;return Promise.resolve({data:F(E({},t),{href:null===(e=t.options)||void 0===e?void 0:e.href,params:null===(n=t.options)||void 0===n?void 0:n.params,url:null===(o=t.options)||void 0===o?void 0:o.url})})},F(E({},e),{refreshDeps:[n.visible]}))}},title:'{{t("Edit")}}',properties:{formSchema:{type:"void",properties:(B(r={type:{type:"string",title:'{{t("Type")}}',"x-decorator":"FormItem","x-component":function(e){return f().createElement(H,{value:e.value})},default:d.NocoBaseDesktopRouteType.page},title:{type:"string",title:'{{t("Title")}}',"x-decorator":"FormItem","x-component":"Input",required:!0},icon:{type:"string",title:'{{t("Icon")}}',"x-decorator":"FormItem","x-component":"IconPicker","x-reactions":a?{dependencies:["type"],fulfill:{state:{required:'{{$deps[0] !== "tabs"}}'}}}:void 0}},a?"url":"href",{title:'{{t("URL")}}',type:"string","x-decorator":"FormItem","x-component":_,description:'{{t("Do not concatenate search params in the URL")}}',"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}}}),B(r,"params",{type:"array","x-component":"ArrayItems","x-decorator":"FormItem",title:'{{t("Search parameters")}}',items:{type:"object",properties:{space:{type:"void","x-component":"Space","x-component-props":{style:{flexWrap:"nowrap",maxWidth:"100%"},className:(0,d.css)(L())},properties:{name:{type:"string","x-decorator":"FormItem","x-component":"Input","x-component-props":{placeholder:'{{t("Name")}}'}},value:{type:"string","x-decorator":"FormItem","x-component":_,"x-component-props":{placeholder:'{{t("Value")}}',useTypedConstant:!0,changeOnSelect:!0}},remove:{type:"void","x-decorator":"FormItem","x-component":"ArrayItems.Remove"}}}}},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "link"}}'}}},properties:{add:{type:"void",title:'{{t("Add parameter")}}',"x-component":"ArrayItems.Addition"}}}),B(r,"hideInMenu",{type:"boolean",title:'{{t("Show in menu")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the route will be displayed in the menu.`)}}"},"x-component":function(e){var t=U((0,y.useState)(!e.value),2),n=t[0],o=t[1];return f().createElement(m.Checkbox,{checked:n,onChange:function(){var t;o(!n),null===(t=e.onChange)||void 0===t||t.call(e,n)}})},default:!1}),B(r,"enableTabs",{type:"boolean",title:'{{t("Enable page tabs")}}',"x-decorator":"FormItem","x-decorator-props":{tooltip:"{{t(`If selected, the page will display Tab pages.`)}}"},"x-component":function(e){return f().createElement(m.Checkbox,{checked:e.value,onChange:e.onChange})},"x-reactions":{dependencies:["type"],fulfill:{state:{hidden:'{{$deps[0] !== "page"}}'}}},default:!1}),r)},footer:{type:"void","x-component":"Action.Drawer.Footer",properties:{cancel:{title:'{{t("Cancel")}}',"x-component":"Action","x-component-props":{useAction:"{{ cm.useCancelAction }}"}},submit:{title:'{{t("Submit")}}',"x-component":"Action","x-component-props":{type:"primary",useAction:function(t){var n=(0,S.useForm)(),o=(0,S.useField)(),r=(0,d.useCollectionRecordData)(),a=(0,d.useActionContext)(),i=(0,d.useDataBlockRequestGetter)().getDataBlockRequest,l=(0,d.useNocoBaseRoutes)(e).updateRoute;return{run:function(){return K(function(){var e,c,u,s,p;return M(this,function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),[4,n.submit()];case 1:return d.sent(),o.data=o.data||{},o.data.loading=!0,(n.values.href||!I().isEmpty(n.values.params))&&(u={href:n.values.href,params:n.values.params}),[4,l(r.id,F(E({},I().omit(n.values,["href","params"])),{options:u}))];case 2:return s=d.sent(),a.setVisible(!1),null==t||t(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.data),[4,n.reset()];case 3:return d.sent(),o.data.loading=!1,null===(c=i())||void 0===c||c.refresh(),[3,5];case 4:throw p=d.sent(),o.data&&(o.data.loading=!1),p;case 5:return[2]}})})()}}}}}}}}}}},access:{type:"void",title:'{{t("View")}}',"x-component":"Action.Link","x-use-component-props":function(){var e=(0,d.useCollectionRecordData)();return{onClick:function(){window.open(e._path,"_blank")},disabled:!e._path}},"x-decorator":"Space"},delete:{type:"void",title:'{{t("Delete")}}',"x-decorator":"Space","x-component":"Action.Link","x-use-component-props":function(){var t=(0,d.useCollectionRecordData)(),n=(0,d.useAPIClient)(),o=(0,y.useMemo)(function(){return n.resource(e)},[n]),r=(0,d.useDataBlockRequestGetter)().getDataBlockRequest,a=W().deleteRouteSchema,i=(0,d.useAllAccessDesktopRoutes)().refresh;return{onClick:K(function(){return M(this,function(e){switch(e.label){case 0:return[4,a(t.schemaUid)];case 1:return e.sent(),o.destroy({filterByTk:t.id}).then(function(){r().refresh(),i()}).catch(function(e){console.error(e)}),[2]}})})}},"x-component-props":{confirm:{title:"{{t('Delete route')}}",content:"{{t('Are you sure you want to delete it?')}}"}}}}}}}}}};function $(e){var t,n,o="uiSchemas",r=(0,d.useAPIClient)(),a=(0,y.useMemo)(function(){return r.resource(o)},[r,o]),i=(0,d.useInsertPageSchema)();return{createRouteSchema:(0,y.useCallback)((t=K(function(t){var n,o,r,l,c,u;return M(this,function(s){switch(s.label){case 0:if(n=t.type,o=e?void 0:(0,R.uid)(),r=(0,R.uid)(),l=(0,R.uid)(),c=n===d.NocoBaseDesktopRouteType.page?(0,R.uid)():void 0,!(u=B({},d.NocoBaseDesktopRouteType.page,e?function(e,t){return{schema:{type:"void",name:e,"x-uid":e,"x-component":"MobilePageProvider","x-settings":"mobile:page","x-decorator":"BlockItem","x-decorator-props":{style:{height:"100%"}},"x-toolbar-props":{draggable:!1,spaceWrapperStyle:{right:-15,top:-15},spaceClassName:J,toolbarStyle:{overflowX:"hidden"}},properties:{header:X,content:function(e){return{type:"void","x-component":"MobilePageContent",properties:B({},e,Q(e))}}(t)}}}}(r,c).schema:(0,d.getPageMenuSchema)({pageSchemaUid:r,tabSchemaUid:c,tabSchemaName:l})))[n])return[2,{}];if(!e)return[3,2];return[4,a.insertAdjacent({resourceIndex:"mobile",position:"beforeEnd",values:{schema:u[n]}})];case 1:return s.sent(),[3,4];case 2:return[4,i(u[n])];case 3:s.sent(),s.label=4;case 4:return[2,{menuSchemaUid:o,pageSchemaUid:r,tabSchemaUid:c,tabSchemaName:l}]}})}),function(e){return t.apply(this,arguments)}),[e,a,i]),createTabRouteSchema:(0,y.useCallback)((n=K(function(t){var n,o,r,i,l;return M(this,function(c){switch(c.label){case 0:return n=t.title,o=t.icon,r=t.parentSchemaUid,i=(0,R.uid)(),l=(0,R.uid)(),[4,a["insertAdjacent/".concat(r)]({position:"beforeEnd",values:{schema:e?Q(i):(0,d.getTabSchema)({title:n,icon:o,schemaUid:i,tabSchemaName:l})}})];case 1:return c.sent(),[2,{tabSchemaUid:i,tabSchemaName:l}]}})}),function(e){return n.apply(this,arguments)}),[e,a])}}function W(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uiSchemas",n=(0,d.useAPIClient)(),o=(0,y.useMemo)(function(){return n.resource(t)},[n,t]),r=(0,d.useAllAccessDesktopRoutes)().refresh;return{deleteRouteSchema:(0,y.useCallback)((e=K(function(e){var t;return M(this,function(n){switch(n.label){case 0:return[4,o["remove/".concat(e)]()];case 1:return t=n.sent(),r(),[2,t]}})}),function(t){return e.apply(this,arguments)}),[o,r])}}function H(e){var t,n,o=(0,h.useTranslation)().t,r=(B(t={},d.NocoBaseDesktopRouteType.group,"blue"),B(t,d.NocoBaseDesktopRouteType.page,"green"),B(t,d.NocoBaseDesktopRouteType.link,"red"),B(t,d.NocoBaseDesktopRouteType.tabs,"orange"),t),a=(B(n={},d.NocoBaseDesktopRouteType.group,o("Group")),B(n,d.NocoBaseDesktopRouteType.page,o("Page")),B(n,d.NocoBaseDesktopRouteType.link,o("Link")),B(n,d.NocoBaseDesktopRouteType.tabs,o("Tab")),n);return f().createElement(m.Tag,{color:r[e.value]},a[e.value])}var J=(0,d.css)("\n  &:first-child {\n    .ant-space-item {\n      width: 30px;\n      height: 30px;\n      transform: rotate(45deg);\n      span {\n        position: relative;\n        bottom: -15px;\n        right: -8px;\n        transform: rotate(-45deg);\n        font-size: 10px;\n      }\n    }\n  }\n  "),X={type:"void","x-component":"MobilePageHeader",properties:{pageNavigationBar:{type:"void","x-component":"MobilePageNavigationBar",properties:{actionBar:{type:"void","x-component":"MobileNavigationActionBar","x-initializer":"mobile:navigation-bar:actions","x-component-props":{spaceProps:{style:{flexWrap:"nowrap"}}},properties:{}}}},pageTabs:{type:"void","x-component":"MobilePageTabs"}}};function Q(e){return{type:"void","x-uid":e,"x-async":!0,"x-component":"Grid","x-component-props":{showDivider:!1},"x-initializer":"mobile:addBlock"}}var Y=G("desktopRoutes","/admin"),Z=function(){var e=g().t,t=(0,d.useSchemaComponentContext)(),n=(0,y.useMemo)(function(){var e,n;return e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o,r,a;o=e,r=t,a=n[t],r in o?Object.defineProperty(o,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[r]=a})}return e}({},t),n=(n={designable:!1},n),Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e},[t]);return f().createElement(d.ExtendCollectionsProvider,{collections:[b]},f().createElement(d.SchemaComponentContext.Provider,{value:n},f().createElement(m.Card,{bordered:!1},f().createElement(d.SchemaComponent,{schema:Y,scope:{t:e}}))))},ee={name:"mobileRoutes",dumpRules:"required",migrationRules:["overwrite","schema-only"],inherit:!1,hidden:!1,description:null,fields:[{key:"ymgf0jxu1kg",name:"parentId",type:"bigInt",interface:"integer",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,isForeignKey:!0,uiSchema:{type:"number",title:'{{t("Parent ID")}}',"x-component":"InputNumber","x-read-pretty":!0}},{key:"b07aqgs2shv",name:"parent",type:"belongsTo",interface:"m2o",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,foreignKey:"parentId",treeParent:!0,onDelete:"CASCADE",uiSchema:{title:'{{t("Parent")}}',"x-component":"AssociationField","x-component-props":{multiple:!1,fieldNames:{label:"id",value:"id"}}},target:"mobileRoutes",targetKey:"id"},{key:"p8sxllsgin1",name:"children",type:"hasMany",interface:"o2m",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,foreignKey:"parentId",treeChildren:!0,onDelete:"CASCADE",uiSchema:{title:'{{t("Children")}}',"x-component":"AssociationField","x-component-props":{multiple:!0,fieldNames:{label:"id",value:"id"}}},target:"mobileRoutes",targetKey:"id",sourceKey:"id"},{key:"7y601o9bmih",name:"id",type:"bigInt",interface:"integer",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,autoIncrement:!0,primaryKey:!0,allowNull:!1,uiSchema:{type:"number",title:'{{t("ID")}}',"x-component":"InputNumber","x-read-pretty":!0}},{key:"m8s9b94amz3",name:"createdAt",type:"date",interface:"createdAt",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,field:"createdAt",uiSchema:{type:"datetime",title:'{{t("Created at")}}',"x-component":"DatePicker","x-component-props":{},"x-read-pretty":!0}},{key:"p3p69woziuu",name:"createdBy",type:"belongsTo",interface:"createdBy",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,target:"users",foreignKey:"createdById",uiSchema:{type:"object",title:'{{t("Created by")}}',"x-component":"AssociationField","x-component-props":{fieldNames:{value:"id",label:"nickname"}},"x-read-pretty":!0},targetKey:"id"},{key:"s0gw1blo4hm",name:"updatedAt",type:"date",interface:"updatedAt",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,field:"updatedAt",uiSchema:{type:"string",title:'{{t("Last updated at")}}',"x-component":"DatePicker","x-component-props":{},"x-read-pretty":!0}},{key:"d1l988n09gd",name:"updatedBy",type:"belongsTo",interface:"updatedBy",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,target:"users",foreignKey:"updatedById",uiSchema:{type:"object",title:'{{t("Last updated by")}}',"x-component":"AssociationField","x-component-props":{fieldNames:{value:"id",label:"nickname"}},"x-read-pretty":!0},targetKey:"id"},{key:"bo7btzkbyan",name:"title",type:"string",interface:"input",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,translation:!0,uiSchema:{type:"string","x-component":"Input",title:'{{t("Title")}}'}},{key:"ozl5d8t2d5e",name:"icon",type:"string",interface:"input",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Icon")}}'}},{key:"6bbyhv00bp4",name:"schemaUid",type:"string",interface:"input",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Schema UID")}}'}},{key:"m0k5qbaktab",name:"type",type:"string",interface:"input",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,uiSchema:{type:"string","x-component":"Input",title:'{{t("Type")}}'}},{key:"ssuml1j2v1b",name:"options",type:"json",interface:"json",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,defaultValue:null,uiSchema:{type:"object","x-component":"Input.JSON","x-component-props":{autoSize:{minRows:5}},default:null,title:'{{t("Options")}}'}},{key:"jjmosjqhz8l",name:"sort",type:"sort",interface:"sort",description:null,collectionName:"mobileRoutes",parentKey:null,reverseKey:null,scopeKey:"parentId",uiSchema:{type:"number","x-component":"InputNumber","x-component-props":{stringMode:!0,step:"1"},"x-validator":"integer",title:'{{t("Sort")}}'}},{type:"belongsToMany",name:"roles",through:"rolesMobileRoutes",target:"roles",onDelete:"CASCADE"},{type:"boolean",name:"hideInMenu",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Hide in menu")}}'}},{type:"boolean",name:"enableTabs",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Enable tabs")}}'}},{type:"boolean",name:"hidden",interface:"checkbox",uiSchema:{type:"boolean","x-component":"Checkbox",title:'{{t("Hidden")}}'}}],category:[],logging:!0,autoGenId:!0,createdAt:!0,createdBy:!0,updatedAt:!0,updatedBy:!0,template:"tree",view:!1,tree:"adjacencyList",filterTargetKey:"id"},et=G("mobileRoutes","/m/page"),en=function(){var e=g().t,t=(0,d.useSchemaComponentContext)(),n=(0,y.useMemo)(function(){var e,n;return e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){var o,r,a;o=e,r=t,a=n[t],r in o?Object.defineProperty(o,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[r]=a})}return e}({},t),n=(n={designable:!1},n),Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n.push.apply(n,o)}return n})(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e},[t]);return f().createElement(d.ExtendCollectionsProvider,{collections:[ee]},f().createElement(d.SchemaComponentContext.Provider,{value:n},f().createElement(m.Card,{bordered:!1},f().createElement(d.SchemaComponent,{schema:et,scope:{t:e}}))))};function eo(e,t,n,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(o,r)}var er=function(){var e,t=(0,h.useTranslation)().t,n=(0,d.useAPIClient)();return f().createElement(d.SchemaSettingsItem,{eventKey:"cache",title:"cache",onClick:(e=function(){return function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,function(e){switch(e.label){case 0:return[4,n.resource("app").clearCache()];case 1:return e.sent(),window.location.reload(),[2]}})},function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function i(e){eo(a,o,r,i,l,"next",e)}function l(e){eo(a,o,r,i,l,"throw",e)}i(void 0)})})},t("Clear cache"))};function ea(e,t,n,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(o,r)}function ei(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function i(e){ea(a,o,r,i,l,"next",e)}function l(e){ea(a,o,r,i,l,"throw",e)}i(void 0)})}}function el(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var ec=function(){var e=(0,h.useTranslation)().t,t=(0,d.useAPIClient)(),n=m.App.useApp().modal;return f().createElement(d.SchemaSettingsItem,{eventKey:"restartApplication",title:"restartApplication",onClick:ei(function(){return el(this,function(o){return n.confirm({title:e("Restart application"),okText:e("Restart"),okButtonProps:{danger:!0},onOk:ei(function(){return el(this,function(e){switch(e.label){case 0:return[4,t.resource("app").restart()];case 1:return e.sent(),[2]}})})}),[2]})})},e("Restart application"))};function eu(e,t,n,o,r,a,i){try{var l=e[a](i),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(o,r)}function es(e,t,n){return(es=ef()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var r=new(Function.bind.apply(e,o));return n&&em(r,n.prototype),r}).apply(null,arguments)}function ep(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ed(e){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function em(e,t){return(em=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ey(e){var t="function"==typeof Map?new Map:void 0;return(ey=function(e){var n;if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return es(e,arguments,ed(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),em(o,e)})(e)}function ef(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ef=function(){return!!e})()}var eb=function(e){var t,n,o;function r(){var e,t,n;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),e=this,t=r,n=arguments,t=ed(t),function(e,t){return t&&("object"===function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}(t)||"function"==typeof t)?t:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ef()?Reflect.construct(t,n||[],ed(e).constructor):t.apply(e,n))}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&em(e,t)}(r,e),t=r,n=[{key:"load",value:function(){var e,t=this;return(e=function(){var e,n;return function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,function(o){return t.app.pluginSettingsManager.add("routes",{title:x("Routes"),icon:"ApartmentOutlined",aclSnippet:"pm.routes"}),t.app.pluginSettingsManager.add("routes.desktop",{title:x("Desktop routes"),Component:Z,aclSnippet:"pm.routes.desktop",sort:1}),t.app.addUserCenterSettingsItem({name:"divider4",sort:499,type:"divider",aclSnippet:"app"}),t.app.addUserCenterSettingsItem({name:"cache",sort:500,Component:er,aclSnippet:"app"}),t.app.addUserCenterSettingsItem({name:"restartApplication",Component:ec,sort:510,aclSnippet:"app"}),(null==(n=t.app.pluginManager.get("@nocobase/plugin-mobile"))?void 0:null===(e=n.options)||void 0===e?void 0:e.enabled)&&t.app.pluginSettingsManager.add("routes.mobile",{title:x("Mobile routes"),Component:en,aclSnippet:"pm.routes.mobile",sort:2}),[2]})},function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function i(e){eu(a,o,r,i,l,"next",e)}function l(e){eu(a,o,r,i,l,"throw",e)}i(void 0)})})()}}],ep(t.prototype,n),r}(ey(d.Plugin));return p}()});