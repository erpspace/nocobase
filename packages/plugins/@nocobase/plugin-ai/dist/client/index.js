/**
 * This file is part of the NocoBase (R) project.
 * Copyright (c) 2020-2024 NocoBase Co., Ltd.
 * Authors: NocoBase Team.
 *
 * This project is dual-licensed under AGPL-3.0 and NocoBase Commercial License.
 * For more information, please refer to: https://www.nocobase.com/agreement.
 */

!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@formily/antd-v5"),require("@formily/shared"),require("@nocobase/utils/client"),require("@formily/core"),require("@nocobase/client"),require("antd"),require("@ant-design/icons"),require("@formily/react"),require("@nocobase/plugin-workflow/client"),require("react")):"function"==typeof define&&define.amd?define("@nocobase/plugin-ai",["@formily/antd-v5","@formily/shared","@nocobase/utils/client","@formily/core","@nocobase/client","antd","@ant-design/icons","@formily/react","@nocobase/plugin-workflow/client","react"],t):"object"==typeof exports?exports["@nocobase/plugin-ai"]=t(require("@formily/antd-v5"),require("@formily/shared"),require("@nocobase/utils/client"),require("@formily/core"),require("@nocobase/client"),require("antd"),require("@ant-design/icons"),require("@formily/react"),require("@nocobase/plugin-workflow/client"),require("react")):e["@nocobase/plugin-ai"]=t(e["@formily/antd-v5"],e["@formily/shared"],e["@nocobase/utils/client"],e["@formily/core"],e["@nocobase/client"],e.antd,e["@ant-design/icons"],e["@formily/react"],e["@nocobase/plugin-workflow/client"],e.react)}(self,function(e,t,n,r,o,i,u,a,l,c){return function(){var s,p,f,m,d,v,y={750:function(e,t,n){"use strict";n.r(t),n.d(t,{Chat:function(){return s}});var r=n(156),o=n.n(r),i=n(721),u=n(772),a=n(505),l=n(903);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var s=function(){var e=(0,l.NT)(),t=Array.from((0,u.usePlugin)("ai").aiManager.chatSettings.entries()).map(function(t){var n,r,i=(r=2,function(e){if(Array.isArray(e))return e}(n=t)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],u=!0,a=!1;try{for(o=o.call(e);!(u=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(e){a=!0,r=e}finally{try{!u&&null!=o.return&&o.return()}finally{if(a)throw r}}return i}}(n,2)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}}(n,r)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0],l=i[1],s=l.title,p=l.Component;return{key:u,label:a.Schema.compile(s,{t:e}),children:o().createElement(p,null)}});return o().createElement(i.Tabs,{items:t})}},261:function(e,t,n){"use strict";n.r(t),n.d(t,{ModelSelect:function(){return c}});var r=n(156),o=n.n(r),i=n(772),u=n(505),a=n(721);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var c=function(){var e,t,n,c,s=(0,u.useField)(),p=(0,u.useForm)(),f=(0,i.useAPIClient)(),m=(0,i.useActionContext)();var d=(e=(0,r.useState)([]),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],u=!0,a=!1;try{for(o=o.call(e);!(u=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(e){a=!0,r=e}finally{try{!u&&null!=o.return&&o.return()}finally{if(a)throw r}}return i}}(e,2)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=d[0],y=d[1],b=(0,i.useRequest)(function(){var e;return f.resource("ai").listModels({llmService:null===(e=p.values)||void 0===e?void 0:e.llmService}).then(function(e){var t,n;return null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.map(function(e){var t=e.id;return{label:t,value:t}})})},{ready:!!(null===(n=p.values)||void 0===n?void 0:n.llmService)&&m.visible,refreshDeps:[null===(c=p.values)||void 0===c?void 0:c.llmService],onSuccess:function(e){return y(e)}}),h=b.data,g=b.loading;return o().createElement(a.AutoComplete,{onSearch:function(e){if(!h){y([]);return}if(!e){y(h);return}y(h.filter(function(t){return t.label.toLowerCase().includes(e.toLowerCase())}))},options:v,notFoundContent:g?o().createElement(a.Spin,{size:"small"}):null,value:s.value,onChange:function(e){return s.value=e}})}},903:function(e,t,n){"use strict";n.d(t,{uD:function(){return i},NT:function(){return u}});var r=JSON.parse('{"u2":"@nocobase/plugin-ai"}'),o=n("772"),i=r.u2;function u(){var e=(0,o.useApp)();return function(t){return e.i18n.t(t,{ns:[r.u2,"client"]})}}},581:function(e){e.exports=function(e,t){return"undefined"!=typeof __deoptimization_sideEffect__&&__deoptimization_sideEffect__(e,t),t}},482:function(e){"use strict";e.exports=u},632:function(t){"use strict";t.exports=e},563:function(e){"use strict";e.exports=r},505:function(e){"use strict";e.exports=a},875:function(e){"use strict";e.exports=t},772:function(e){"use strict";e.exports=o},433:function(e){"use strict";e.exports=l},584:function(e){"use strict";e.exports=n},721:function(e){"use strict";e.exports=i},156:function(e){"use strict";e.exports=c}},b={};function h(e){var t=b[e];if(void 0!==t)return t.exports;var n=b[e]={exports:{}};return y[e](n,n.exports,h),n.exports}h.m=y,h.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(t,{a:t}),t},h.d=function(e,t){for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.f={},h.e=function(e){return Promise.all(Object.keys(h.f).reduce(function(t,n){return h.f[n](e,t),t},[]))},h.u=function(e){return""+({135:"83ce71fb5895b112",506:"6f221c7c3acd67ae"})[e]+".js"},h.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),h.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s={},p="@nocobase/plugin-ai:",h.l=function(e,t,n,r){if(s[e]){s[e].push(t);return}if(void 0!==n){for(var o,i,u=document.getElementsByTagName("script"),a=0;a<u.length;a++){var l=u[a];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==p+n){o=l;break}}}!o&&(i=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,h.nc&&o.setAttribute("nonce",h.nc),o.setAttribute("data-webpack",p+n),o.src=e),s[e]=[t];var c=function(t,n){o.onerror=o.onload=null,clearTimeout(f);var r=s[e];if(delete s[e],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(function(e){return e(n)}),t)return t(n)},f=setTimeout(c.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=c.bind(null,o.onerror),o.onload=c.bind(null,o.onload),i&&document.head.appendChild(o)},h.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p=(!(f=window.__nocobase_public_path__||"/").endsWith("/")&&(f+="/"),f+"static/plugins/@nocobase/plugin-ai/dist/client/"),m={909:0},h.f.j=function(e,t){var n=h.o(m,e)?m[e]:void 0;if(0!==n){if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=m[e]=[t,r]});t.push(n[2]=r);var o=h.p+h.u(e),i=Error();h.l(o,function(t){if(h.o(m,e)&&(0!==(n=m[e])&&(m[e]=void 0),n)){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;i.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",i.name="ChunkLoadError",i.type=r,i.request=o,n[1](i)}},"chunk-"+e,e)}}},d=function(e,t){var n=t[0],r=t[1],o=t[2],i,u,a=0;if(n.some(function(e){return 0!==m[e]})){for(i in r)h.o(r,i)&&(h.m[i]=r[i]);o&&o(h)}for(e&&e(t);a<n.length;a++)u=n[a],h.o(m,u)&&m[u]&&m[u][0](),m[u]=0},(v=self.webpackChunk_nocobase_plugin_ai=self.webpackChunk_nocobase_plugin_ai||[]).forEach(d.bind(null,0)),v.push=d.bind(null,v.push.bind(v));var g={};return!function(){"use strict";h.r(g),h.d(g,{default:function(){return G},PluginAIClient:function(){return V},Chat:function(){return B},ModelSelect:function(){return W}});var e=h("772"),t=h("584");function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(){var e,o,i;function u(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,u),r(this,"llmProviders",new t.Registry),r(this,"chatSettings",new Map)}return e=u,o=[{key:"registerLLMProvider",value:function(e,t){this.llmProviders.register(e,t)}}],n(e.prototype,o),u}(),i=h("156"),u=h.n(i),a=h("903"),l=h("721"),c=h("433"),s=h("261"),p=h("750"),f=function(){var n=(0,a.NT)();return u().createElement("div",{style:{marginBottom:24}},u().createElement(l.Collapse,{bordered:!1,size:"small",items:[{key:"options",label:n("Options"),forceRender:!0,children:u().createElement(e.SchemaComponent,{schema:{type:"void",name:"openai",properties:{frequencyPenalty:{title:(0,t.tval)("Frequency penalty",{ns:a.uD}),description:(0,t.tval)("Frequency penalty description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:0,"x-component-props":{step:.1,min:-2,max:2}},maxCompletionTokens:{title:(0,t.tval)("Max completion tokens",{ns:a.uD}),description:(0,t.tval)("Max completion tokens description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:-1},presencePenalty:{title:(0,t.tval)("Presence penalty",{ns:a.uD}),description:(0,t.tval)("Presence penalty description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:0,"x-component-props":{step:.1,min:-2,max:2}},temperature:{title:(0,t.tval)("Temperature",{ns:a.uD}),description:(0,t.tval)("Temperature description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:.7,"x-component-props":{step:.1,min:0,max:1}},topP:{title:(0,t.tval)("Top P",{ns:a.uD}),description:(0,t.tval)("Top P description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:1,"x-component-props":{step:.5,min:0,max:1}},responseFormat:{title:(0,t.tval)("Response format",{ns:a.uD}),description:(0,t.tval)("Response format description",{ns:a.uD}),type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:n("Text"),value:"text"},{label:n("JSON"),value:"json_object"},{label:n("JSON Schema"),value:"json_schema"}],default:"text"},timeout:{title:(0,t.tval)("Timeout (ms)",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:6e4},maxRetries:{title:(0,t.tval)("Max retries",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:1}}}})}]}))},m=function(){return u().createElement(e.SchemaComponent,{schema:{type:"void",properties:{apiKey:{title:(0,t.tval)("API key",{ns:a.uD}),type:"string",required:!0,"x-decorator":"FormItem","x-component":"TextAreaWithGlobalScope"},baseURL:{title:(0,t.tval)("Base URL",{ns:a.uD}),type:"string","x-decorator":"FormItem","x-component":"TextAreaWithGlobalScope"}}}})},d={components:{ProviderSettingsForm:m,ModelSettingsForm:function(){return u().createElement(e.SchemaComponent,{components:{Options:f,WorkflowVariableRawTextArea:c.WorkflowVariableRawTextArea,ModelSelect:s.ModelSelect,Chat:p.Chat},schema:{type:"void",properties:{model:{title:(0,t.tval)("Model",{ns:a.uD}),type:"string",required:!0,"x-decorator":"FormItem","x-component":"ModelSelect"},options:{type:"void","x-component":"Options"},chat:{type:"void","x-component":"Chat"}}}})}}},v=function(){var n=(0,a.NT)();return u().createElement("div",{style:{marginBottom:24}},u().createElement(l.Collapse,{bordered:!1,size:"small",items:[{key:"options",label:n("Options"),forceRender:!0,children:u().createElement(e.SchemaComponent,{schema:{type:"void",name:"deepseek",properties:{frequencyPenalty:{title:(0,t.tval)("Frequency penalty",{ns:a.uD}),description:(0,t.tval)("Frequency penalty description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:0,"x-component-props":{step:.1,min:-2,max:2}},maxCompletionTokens:{title:(0,t.tval)("Max completion tokens",{ns:a.uD}),description:(0,t.tval)("Max completion tokens description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:-1},presencePenalty:{title:(0,t.tval)("Presence penalty",{ns:a.uD}),description:(0,t.tval)("Presence penalty description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:0,"x-component-props":{step:.1,min:-2,max:2}},temperature:{title:(0,t.tval)("Temperature",{ns:a.uD}),description:(0,t.tval)("Temperature description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:.7,"x-component-props":{step:.1,min:0,max:1}},topP:{title:(0,t.tval)("Top P",{ns:a.uD}),description:(0,t.tval)("Top P description",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:1,"x-component-props":{step:.5,min:0,max:1}},responseFormat:{title:(0,t.tval)("Response format",{ns:a.uD}),description:(0,t.tval)("Response format description",{ns:a.uD}),type:"string","x-decorator":"FormItem","x-component":"Select",enum:[{label:n("Text"),value:"text"},{label:n("JSON"),value:"json_object"}],default:"text"},timeout:{title:(0,t.tval)("Timeout (ms)",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:6e4},maxRetries:{title:(0,t.tval)("Max retries",{ns:a.uD}),type:"number","x-decorator":"FormItem","x-component":"InputNumber",default:1}}}})}]}))},y={components:{ProviderSettingsForm:m,ModelSettingsForm:function(){return u().createElement(e.SchemaComponent,{components:{Options:v,WorkflowVariableRawTextArea:c.WorkflowVariableRawTextArea,ModelSelect:s.ModelSelect,Chat:p.Chat},schema:{type:"void",properties:{model:{title:(0,t.tval)("Model",{ns:a.uD}),type:"string",required:!0,"x-decorator":"FormItem","x-component":"ModelSelect"},options:{type:"void","x-component":"Options"},chat:{type:"void","x-component":"Chat"}}}})}}},b=h("482"),x=h("505"),S=function(t){var n,r=(0,e.usePlugin)(G).aiManager.llmProviders.get(t);return null==r?void 0:null===(n=r.components)||void 0===n?void 0:n.ModelSettingsForm},w=(0,x.observer)(function(){var t,n,r=(0,x.useForm)(),o=(0,e.useAPIClient)(),i=(0,e.useRequest)(function(){var e;return o.resource("llmServices").get({filterByTk:null===(e=r.values)||void 0===e?void 0:e.llmService}).then(function(e){var t;return null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.data})},{ready:!!(null===(t=r.values)||void 0===t?void 0:t.llmService),refreshDeps:[null===(n=r.values)||void 0===n?void 0:n.llmService]}),a=i.data,l=i.loading,c=S(null==a?void 0:a.provider);return l?null:c?u().createElement(c,null):null},{displayName:"WorkflowLLMModelSettingsForm"});function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(O=function(){return!!e})()}var I=function(e){var n,r,o;function i(){var e,n,r,o;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),n=this,r=i,o=arguments,r=k(r),_(e=function(e,t){return t&&("object"===function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}(t)||"function"==typeof t)?t:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(n,O()?Reflect.construct(r,o||[],k(n).constructor):r.apply(n,o)),"title","LLM"),_(e,"type","llm"),_(e,"group","ai"),_(e,"icon",u().createElement(b.RobotOutlined,null)),_(e,"fieldset",{llmService:{type:"string",title:(0,t.tval)("LLM service",{ns:a.uD}),name:"llmService",required:!0,"x-decorator":"FormItem","x-component":"RemoteSelect","x-component-props":{manual:!1,fieldNames:{label:"title",value:"name"},service:{resource:"llmServices",action:"list",params:{fields:["title","name"]}}}},options:{type:"void","x-component":"Settings"}}),_(e,"components",{Settings:w}),e}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(i,e),n=i,r=[{key:"isAvailable",value:function(e){var t=e.engine,n=e.workflow;return!t.isWorkflowSync(n)}},{key:"useVariables",value:function(e,t){return{label:e.title,value:e.key,children:[{value:"content",label:"Content"},{value:"structuredContent",label:"Structured content"},{value:"additionalKwargs",label:"Additional Kwargs"}]}}}],P(n.prototype,r),i}(c.Instruction),C=h(581);function j(e,t,n,r,o,i,u){try{var a=e[i](u),l=a.value}catch(e){n(e);return}a.done?t(l):Promise.resolve(l).then(r,o)}function T(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function u(e){j(i,r,o,u,a,"next",e)}function a(e){j(i,r,o,u,a,"throw",e)}u(void 0)})}}function F(e,t,n){return(F=N()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&E(o,n.prototype),o}).apply(null,arguments)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t="function"==typeof Map?new Map:void 0;return(q=function(e){var n;if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return F(e,arguments,A(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),E(r,e)})(e)}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(N=function(){return!!e})()}function R(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var L=(0,e.lazy)(function(){return C("imported_13abd9v_component",h.e("506").then(h.bind(h,387)))},"LLMServices").LLMServices,z=(0,e.lazy)(function(){return C("imported_2m5erh_component",h.e("135").then(h.bind(h,950)))},"MessagesSettings").MessagesSettings,B=(0,e.lazy)(function(){return C("imported_12hvp9m_component",Promise.resolve().then(h.bind(h,750)))},"Chat").Chat,W=(0,e.lazy)(function(){return C("imported_-1d7bfm6_component",Promise.resolve().then(h.bind(h,261)))},"ModelSelect").ModelSelect,V=function(e){var n,r,i;function u(){var e,t,n,r,i,a,l;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,u),t=this,n=u,r=arguments,n=A(n),i=e=function(e,t){return t&&("object"===function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}(t)||"function"==typeof t)?t:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(t,N()?Reflect.construct(n,r||[],A(t).constructor):n.apply(t,r)),a="aiManager",l=new o,a in i?Object.defineProperty(i,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[a]=l,e}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(u,e),n=u,r=[{key:"afterAdd",value:function(){return T(function(){return R(this,function(e){return[2]})})()}},{key:"beforeLoad",value:function(){return T(function(){return R(this,function(e){return[2]})})()}},{key:"load",value:function(){var e=this;return T(function(){var n;return R(this,function(r){return e.app.pluginSettingsManager.add("ai",{icon:"RobotOutlined",title:(0,t.tval)("AI integration",{ns:a.uD}),aclSnippet:"pm.ai"}),e.app.pluginSettingsManager.add("ai.llm-services",{icon:"LinkOutlined",title:(0,t.tval)("LLM services",{ns:a.uD}),aclSnippet:"pm.ai.llm-services",Component:L}),e.aiManager.registerLLMProvider("openai",d),e.aiManager.registerLLMProvider("deepseek",y),e.aiManager.chatSettings.set("messages",{title:(0,t.tval)("Messages"),Component:z}),(n=e.app.pm.get("workflow")).registerInstructionGroup("ai",{label:(0,t.tval)("AI",{ns:a.uD})}),n.registerInstruction("llm",I),[2]})})()}}],D(n.prototype,r),u}(q(e.Plugin)),G=V}(),g}()});